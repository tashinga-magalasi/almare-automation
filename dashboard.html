<!DOCTYPE html>
<html>
<head>
  <title>Almare Automation Dashboard</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      background: #f4f6f8;
    }
    h2 {
      margin-top: 40px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      background: #fff;
      margin-top: 10px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      font-size: 14px;
    }
    th {
      background: #333;
      color: white;
    }
    .success {
      color: green;
      font-weight: bold;
    }
    .failed {
      color: red;
      font-weight: bold;
    }
  </style>
</head>
<body>

<h1>Automation Dashboard</h1>

<!-- LOGS -->
<h2>Execution Logs</h2>
<table id="logsTable">
  <tr>
    <th>Timestamp</th>
    <th>Status</th>
    <th>Duration (ms)</th>
    <th>Error</th>
  </tr>
</table>

<!-- EXCEL DATA -->
<h2>Excel Data</h2>
<table id="excelTable"></table>

<script>
// Load Logs
fetch('logs.json')
  .then(res => res.json())
  .then(data => {
    const table = document.getElementById('logsTable');
    data.forEach(log => {
      const row = table.insertRow();
      row.insertCell().innerText = log.timestamp;
      row.insertCell().innerHTML =
        `<span class="${log.status}">${log.status}</span>`;
      row.insertCell().innerText = log.duration_ms;
      row.insertCell().innerText = log.error || '';
    });
  });

// Load Excel Data
fetch('excel-data.json')
  .then(res => res.json())
  .then(data => {
    const table = document.getElementById('excelTable');

    if (data.length === 0) {
      table.innerHTML = '<tr><td>No data found</td></tr>';
      return;
    }

    // Header
    const header = table.insertRow();
    data[0].forEach((_, i) => {
      const th = document.createElement('th');
      th.innerText = `Column ${i + 1}`;
      header.appendChild(th);
    });

    // Rows
    data.forEach(rowData => {
      const row = table.insertRow();
      rowData.forEach(cell => {
        row.insertCell().innerText = cell ?? '';
      });
    });
  });
</script>

</body>
</html>
